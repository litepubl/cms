(function(d,c){c.Tablecols=Class.extend({dropdown:!1,table:!1,headers:!1,columns:!1,keystorage:"",tml:'<li class="checkbox"><label><input type="checkbox" value="%%index%%" %%checked%% />%%title%%</label></li>',init:function(a,b){this.dropdown=d(a);this.table=this.dropdown.parent().find("table:first");this.headers=this.table.find("tr:first");this.keystorage=this.getkeystorage();"DataStorage"in c?this.load():d.load_script(ltoptions.files+"/js/litepubl/system/storage.min.js",d.proxy(this.load,this));
b&&(this.tml=b);this.init_dropdown()},set:function(a,b){this.columns[b++]=a;this.table.find("td:nth-child("+b+"),th:nth-child("+b+")")[a?"addClass":"removeClass"]("hidden")},load:function(){var a=c.getdatastorage().get(this.keystorage);if(a){this.columns=a;for(var b=0;b<a.length;b++)this.set(a[b],b)}else a=this.headers.find("th"),this.columns=[],this.columns.length=a.length},save:function(){c.getdatastorage().set(this.keystorage,this.columns)},getkeystorage:function(){var a="tablecols";ltoptions.idurl&&
(a+=ltoptions.idurl);return a},init_dropdown:function(){var a=this;this.dropdown.find("button").dropdown().off("click.bs.dropdown").on("click.tablecols",function(){var b=d(this),c=b.parent();c.hasClass("open")||c.find(".dropdown-menu").html(a.getmenu());b.dropdown("toggle");return!1});this.dropdown.find(".dropdown-menu").on("click.tablecols",function(b){b.stopPropagation();b=d(b.target);b.is("[type=checkbox]")&&(a.set(!b.prop("checked"),b.val()),a.save())})},getmenu:function(){var a="",b=this.tml,
c=this.columns;this.headers.find("th").each(function(e){var f=d(this);f.hasClass("col-checkbox")||(a+=d.parsetml(b,{index:e,title:f.text(),checked:c[e]?"":'checked="checked"'}))});return a}})})(jQuery,litepubl);
