(function(d,g,c){c.tml.tablecols={hidecol:'<a href="#"  class="hidecolumn dashed tooltip-toggle" title="%%lang.hidecol%%"><span class="fa fa-caret-up"></span> </a>',dropdown:'<div class="dropdown"><button type="button" class="btn btn-default dropdown-toggle" id="guid-%%guid%%" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">%%title%%    <span class="caret"></span></button><ul class="dropdown-menu" aria-labelledby="guid-%%guid%%"></ul></div>',item:'<li><label class="checkbox"><input type="checkbox" value="%%index%%" %%checked%% />%%title%%</label></li>'};
c.Tablecols=Class.extend({table:!1,headers:!1,dropdown:!1,columns:!1,keystorage:"",init:function(a){this.table=d(a);this.headers=this.table.find("tr:first");var b=this;this.headers.on("click.hidecolumn",".hidecolumn",function(){b.set(!0,d(this).closest("th").index());b.save();return!1});a=this.headers.find("th");this.columns=[];this.columns.length=a.length;var e=c.tml.tablecols.hidecol.replace("%%lang.hidecol%%",lang.admin.hidecol);a.each(function(){var a=d(this);a.has("input").length?a.addClass("col-ignore"):
(a.data("title",a.text()),a.prepend(e))});this.keystorage=this.getkeystorage();this.load();this.create_dropdown()},set:function(a,b){this.columns[b++]=a;this.table.find("td:nth-child("+b+"),th:nth-child("+b+")")[a?"addClass":"removeClass"]("hidden")},load:function(){var a=c.getdatastorage().get(this.keystorage);if(a){this.columns=a;for(var b=0;b<a.length;b++)this.set(a[b],b)}},save:function(){c.getdatastorage().set(this.keystorage,this.columns)},getkeystorage:function(){var a="tablecols";ltoptions.idurl&&
(a+=ltoptions.idurl);return a},create_dropdown:function(){var a=d.parsetml(c.tml.tablecols.dropdown,{guid:c.guid++,title:lang.admin.togglecols}),b=this;this.dropdown=d(a).insertBefore(this.table.closest("form"));this.dropdown.find("button").dropdown().off("click.bs.dropdown").on("click.tablecols",function(){var a=d(this),c=a.parent();c.hasClass("open")||c.find(".dropdown-menu").html(b.getmenu());a.dropdown("toggle");return!1});this.dropdown.find(".dropdown-menu").on("click.tablecols",function(a){a.stopPropagation();
a=d(a.target);a.is("[type=checkbox]")&&(b.set(!a.prop("checked"),a.val()),b.save())})},getmenu:function(){var a="",b=c.tml.tablecols.item,e=this.columns;this.headers.find("th").each(function(c){var f=d(this);f.hasClass("col-ignore")||(a+=d.parsetml(b,{index:c,title:f.data("title"),checked:e[c]?"":'checked="checked"'}))});return a}});d(g).ready(function(){c.tablecols=new c.Tablecols("table:first")})})(jQuery,document,litepubl);
