(function(f,k){function g(d){if(!b||b.error)return!1;var a=f(window),c=a.width(),a=a.height(),b=d.data("homeimage");if(b.winw!=c||b.winh!=a){b.winw=c;b.winh=a;var e=c>=b.breakpoint?b.large:b.small;if(e!=b.cur)if(e.w)b.cur=e,b.img.prop("src",e.src);else{if(e.src)return h(e,function(){b.winw=0;g(self)},function(){e.src=!1;b.winw=0;g(self)});e=b.cur}d=self.width();c=Math.min(a-b.top,d,e.h);self.height(c);a=e.w/e.h*c;b.img.width(a);b.img.height(c);b.img.css("left",(d-a)/2)}}function h(d,a,c){var b=new Image;
b.onload=function(){this.onload=this.onerror=null;d.w=this.width;d.h=this.height;a()};b.onerror=function(){this.onload=this.onerror=null;c()};b.src=d.src}f.fn.homeimage=function(){if(!this.length||this.data("homeimage"))return this;var d=this,a={cur:!1,error:!1,breakpoint:this.attr("data-smallwidth")||768,top:this.position().top,winw:0,winh:0,img:!1,large:{w:0,h:0,src:this.attr("data-image")||this.find("img").attr("src")},small:{w:0,h:0,src:this.attr("data-small")}};this.data("homeimage",a);if(!a.large.src&&
!a.small.src)return this.hide();var c=f(window).width()>=a.breakpoint?a.large:a.small;c.src||(c=c==a.small?a.large:a.small);a.cur=c;h(c,function(){a.img=f('<img src="'+a.cur.src+'" />').appendTo(d);f(window).on("resize.homeimage",function(){g(d)});g(d)},function(){a.error=!0;d.hide();alert("Error! Home image not load")});return this};f(k).ready(function(){f("#homeimage").homeimage()})})(jQuery,document);
