(function(a,e,f){litepubl.Mediaplayer=Class.extend({tml:{video:'<video src="%%siteurl%%/files/%%file.filename%%" type="%%file.mime%%" controls="controls" autoplay="autoplay"></video>',pretty:'<div id="pretty-video-holder"></div>',holder:"#pretty-video-holder"},width:450,height:300,clicked:!1,tmplink:!1,script:!1,ready:function(c){this.script?this.script.done(c):(a.load_css(ltoptions.files+"/js/mediaelement/css/mediaelementplayer.min.css"),this.script=a.load_script(ltoptions.files+"/js/mediaelement/videoplayer.min.js",
c))},init:function(a,b){this.width=ltoptions.video_width;this.height=ltoptions.video_height;if(a.length){var d=this;this.ready(function(){d.init_audio(a)})}b.length&&this.init_video(b)},init_audio:function(a){a.videoplayer({audioWidth:400,audioHeight:30,startVolume:1})},init_video:function(c){this.tmplink=a('<a href="#custom=true&width='+this.width+"&height="+this.height+'"></a>').appendTo(a('<div class="hidden"></div>').appendTo("body").hide());var b=this,d=this.tml;c.on("click.playvideo",function(c){b.clicked=
a(this);c.preventDefault();b.tmplink.click()});this.tmplink.prettyPhoto({custom_markup:d.pretty,default_width:this.width,default_height:this.height,opacity:.8,modal:!0,deeplinking:!1,keyboard_shortcuts:!1,show_title:!1,social_tools:!1,callback:function(){a(e).off("keydown.onEscape");b.clicked=!1},changepicturecallback:function(){a.onEscape(a.prettyPhoto.close);b.ready(function(){b.init_mediaelement()})}})},init_mediaelement:function(){var c=this.tml,b=a.simpletml(c.video,{file:this.clicked.data("file"),
siteurl:ltoptions.files});a(b).appendTo(c.holder).videoplayer({})}});a(e).ready(function(){litepubl.mediaplayer=new litepubl.Mediaplayer(a("audio"),a(".videofile"))})})(jQuery,document,window);
