(function(b,d,e){e.Polls=Class.extend({voted:!1,init:function(){this.voted=[];var c=this;b(d).on("click.poll",".poll-vote",function(){var a=b(this);c.addvote(a.attr("data-vote"),a.closest(".poll-opened"));return!1}).on("show.bs.tooltip.poll",".poll-star",function(a){a=b(a.target);c.changestars(a.attr("data-vote"),a.closest(".poll-opened"))}).on("hide.bs.tooltip.poll",".poll-star",function(a){b(a.target).closest(".poll-opened").find("fa-star").removeClass("fa-star").addClass("fa-star-o")})},addvote:function(c,
a){var f=a.attr("data-idpoll");if(0<=b.inArray(f,this.voted))return this.error(lang.poll.voted);this.voted.push(f);this.changestars(c,a);var d=this;e.authdialog.check({rpc:{type:"get",method:"polls_sendvote",params:{idpoll:f,vote:c},callback:function(b){a.find(".tooltip-toggle, .tooltip-ready").tooltip("destroy");a.html(b.html);a.find("tooltip-toggle").removeClass("tooltip-toggle");d.changestars(c,a)},error:function(a,c){b.errorbox(a)}}})},changestars:function(c,a){a.hasClass("poll-stars")&&a.find("poll-star").each(function(){c>=
b(this).attr("data-vote")&&b("fa",this).removeClass("fa-star-o").addClass("fa-star")})}});b(d).ready(function(){e.polls=new e.Polls})})(jQuery,document,litepubl);
