function set_progress(a,b){switch(a){case -1:$(b).hide();break;case 0:$(b).show();$(b+" .uploadedpercent").text(a+" %");break;default:$(b+" .uploadedpercent").text(a+" %")}}function fileDialogComplete(a,b){set_progress(0,this.customSettings.progress);var c=window.location.toString(),c=c+(-1==c.indexOf("?")?"?":"&");this.setUploadURL(c+"random="+Math.random());this.startUpload()}function uploadStart(a){return!0}
function uploadProgress(a,b,c){set_progress(Math.ceil(b/c*100),this.customSettings.progress)}function uploadError(a,b,c){set_progress(-1,this.customSettings.progress);alert("uploadError")}function uploadComplete(a){set_progress(-1,this.customSettings.progress)}function uploadSuccess(a,b){if("logourl"==this.customSettings.name){var c=$.parseJSON(b);$("#logo").css("padding-left",c.width);$("#text-color-logowidth").val(c.width);set_color("logourl",c.url)}else set_color(this.customSettings.name,b)}
function createswfu(a){a={flash_url:ltoptions.files+"/js/swfupload/swfupload.swf",upload_url:document.location,post_params:{formtype:a?"headerurl":"logourl"},file_size_limit:a?"4 MB":"10 MB",file_types:a?"*.jpg;*.png;*.gif":"*.png",file_types_description:"Images",file_upload_limit:100,file_queue_limit:1,button_image_url:ltoptions.files+"/js/swfupload/images/XPButtonNoText_160x22.png",button_text:'<span class="upload_button">'+(a?lang.themegenerator.upload_header:lang.themegenerator.upload_logo)+"</span>",
button_placeholder_id:a?"uploadbutton":"uploadlogo",button_width:160,button_height:22,button_text_style:".upload_button { font-family: Helvetica, Arial, sans-serif; font-size: 14pt; text-align: center; }",button_text_top_padding:1,button_text_left_padding:5,custom_settings:{name:a?"headerurl":"logourl",progress:a?"#progress_image":"#progress_logo"},file_dialog_complete_handler:fileDialogComplete,upload_start_handler:uploadStart,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,
upload_success_handler:uploadSuccess,upload_complete_handler:uploadComplete};try{return new SWFUpload(a)}catch(b){alert("Error create swfupload "+b.message)}}
function set_color(a,b){if("themename"==a)$("#text-themename").val(b);else{var c=$("#text-color-"+a);if(0!=c.length){c.val(b);for(var c=0,e=ltoptions.colors.length;c<e;c++){var d=ltoptions.colors[c];if(a==d.name){var f=d.value.replace("%%"+a+"%%",b),g=f.split("%%");2<=g.length&&(g=g[1],f=f.replace("%%"+g+"%%",$("#text-color-"+g).val()));try{var h=d.sel;-1==h.indexOf(":")?$(h).css(d.propname,f):$("head:first").append('<style type="text/css">'+h+"{"+d.propname+":"+f+"}</style>")}catch(k){alert(d.sel+
"\n"+d.propname+" = "+f)}}}}}}function parse_ini(a){a=a.split("\n");for(var b=0,c=a.length;b<c;b++){var e=$.trim(a[b]);if(""!=e&&"["!=e.charAt(0)){var d=e.split("=");2==d.length&&(e=$.trim(d[0]),d=$.trim(d[1].replace('"',"").replace('"',"")),""!==e&&""!=d&&set_color(e,d))}}}
$(document).ready(function(){$("#menucolors, #ini_colors").click(function(){$("#"+$(this).attr("id")+"_toggle").slideToggle();return!1});ltoptions.swfu=createswfu(!0);ltoptions.swfulogo=createswfu(!1);$("input[id^='colorbutton']").ColorPicker({onSubmit:function(a,b,c,e){$(e).ColorPickerHide();try{set_color($(e).attr("rel"),b)}catch(d){alert(d.message)}},onBeforeShow:function(){var a="#text-color-"+$(this).attr("rel");$(this).ColorPickerSetColor($(a).val())}});$("#uploadcolor").submit(function(){parse_ini($("#inicolors").val());
$("#inicolors").val("");return!1})});
