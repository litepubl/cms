(function(b,k,e){litepubl.photoswipePlugin=Class.extend({links:!1,opened:!1,photoswipe:!1,holder:!1,options:{},init:function(a){if(!a.length)return!1;var c=this;this.options={galleryPIDs:!0,showHideOpacity:!0,getThumbBoundsFn:!1,errorMsg:'<div class="pswp__error-msg"><a href="%url%" target="_blank">'+lang.photoswipe.error+"</a></div>"};this.links=a.on("click.photoswipe",function(){c.open(b(this));return!1});litepubl.tml.photoswipe=b.parsetml(litepubl.tml.photoswipe,{lang:lang.photoswipe})},open:function(a){if(this.opened)return!1;
this.opened=!0;a=this.getitems(a);this.holder=b(litepubl.tml.photoswipe).appendTo("body");a=this.photoswipe=new PhotoSwipe(this.holder.get(0),PhotoSwipeUI_Default,a,this.options);a.listen("destroy",b.proxy(this.doclose,this));a.init()},doclose:function(){this.photoswipe=!1;this.holder.remove();this.opened=this.holder=!1},getitems:function(a){var c=[],f=a.data("idpost"),e=a.data("file").id,g=0,h=this.options;h.galleryUID=parseInt(f);this.links.each(function(){g++;var a=b(this);if(f==a.data("idpost")){var d=
a.data("file");e==d.id&&(h.index=c.length);c.push({src:a.attr("href"),w:parseInt(d.width),h:parseInt(d.height),title:a.attr("title"),pid:parseInt(d.id),linkindex:g})}});return c}});b(e).ready(function(){litepubl.photoswipe=new litepubl.photoswipePlugin(b(".photo"))})})(jQuery,window,document);
